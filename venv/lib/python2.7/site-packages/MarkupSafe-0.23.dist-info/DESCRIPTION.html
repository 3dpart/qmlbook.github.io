<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>MarkupSafe &mdash; Qt5 Cadaques Book v2015-03</title>
    
    <link rel="stylesheet" href="../../../../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../../../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../../../_static/bootswatch-3.3.4/sandstone/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../../../../_static/bootstrap-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../../../',
        VERSION:     '2015-03',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../../../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../../../../_static/bootstrap-3.3.4/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../../../../_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="Qt5 Cadaques Book v2015-03" href="../../../../../index.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body role="document">

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../../../../index.html">
          QmlBook</a>
        <span class="navbar-text navbar-version pull-left"><b>2015-03</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../../../../index.html">Chapters <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../en/ch01/index.html">1. Meet Qt 5</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../en/ch02/index.html">2. Get Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../en/ch03/index.html">3. Qt Creator IDE</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../en/ch04/index.html">4. Quick Starter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../en/ch05/index.html">5. Fluid Elements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../en/ch06/index.html">6. Model-View-Delegate</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../en/ch07/index.html">7. Canvas Element</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../en/ch08/index.html">8. Particle Simulations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../en/ch09/index.html">9. Shader Effects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../en/ch10/index.html">10. Multimedia</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../en/ch11/index.html">11. Networking</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../en/ch12/index.html">12. Storage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../en/ch13/index.html">13. Dynamic QML</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../en/ch14/index.html">14. JavaScript</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../en/ch15/index.html">15. Qt and C++</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../en/ch16/index.html">16. Extending QML with C++</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../assets/index.html">16. Assets</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">MarkupSafe</a><ul>
<li><a class="reference internal" href="#html-representations">HTML Representations</a></li>
<li><a class="reference internal" href="#silent-escapes">Silent Escapes</a></li>
<li><a class="reference internal" href="#new-style-string-formatting">New-Style String Formatting</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
              
            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../../../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      
  <div class="section" id="markupsafe">
<h1>MarkupSafe<a class="headerlink" href="#markupsafe" title="Permalink to this headline">¶</a></h1>
<p>Implements a unicode subclass that supports HTML strings:</p>
<div class="highlight-qml"><div class="highlight"><pre><span class="o">&gt;&gt;&gt;</span> <span class="nx">from</span> <span class="nx">markupsafe</span> <span class="kr">import</span> <span class="nx">Markup</span><span class="p">,</span> <span class="nx">escape</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nx">escape</span><span class="p">(</span><span class="s2">&quot;&lt;script&gt;alert(document.cookie);&lt;/script&gt;&quot;</span><span class="p">)</span>
<span class="nx">Markup</span><span class="p">(</span><span class="nx">u</span><span class="s1">&#39;&amp;lt;script&amp;gt;alert(document.cookie);&amp;lt;/script&amp;gt;&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nx">tmpl</span> <span class="o">=</span> <span class="nx">Markup</span><span class="p">(</span><span class="s2">&quot;&lt;em&gt;%s&lt;/em&gt;&quot;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nx">tmpl</span> <span class="o">%</span> <span class="s2">&quot;Peter &gt; Lustig&quot;</span>
<span class="nx">Markup</span><span class="p">(</span><span class="nx">u</span><span class="s1">&#39;&lt;em&gt;Peter &amp;gt; Lustig&lt;/em&gt;&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>If you want to make an object unicode that is not yet unicode
but don&#8217;t want to lose the taint information, you can use the
<cite>soft_unicode</cite> function.  (On Python 3 you can also use <cite>soft_str</cite> which
is a different name for the same function).</p>
<div class="highlight-qml"><div class="highlight"><pre><span class="o">&gt;&gt;&gt;</span> <span class="nx">from</span> <span class="nx">markupsafe</span> <span class="kr">import</span> <span class="nx">soft_unicode</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nx">soft_unicode</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="nx">u</span><span class="s1">&#39;42&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nx">soft_unicode</span><span class="p">(</span><span class="nx">Markup</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">))</span>
<span class="nx">Markup</span><span class="p">(</span><span class="nx">u</span><span class="s1">&#39;foo&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="html-representations">
<h2>HTML Representations<a class="headerlink" href="#html-representations" title="Permalink to this headline">¶</a></h2>
<p>Objects can customize their HTML markup equivalent by overriding
the <cite>__html__</cite> function:</p>
<div class="highlight-qml"><div class="highlight"><pre><span class="o">&gt;&gt;&gt;</span> <span class="kr">class</span> <span class="nx">Foo</span><span class="p">(</span><span class="nx">object</span><span class="p">)</span><span class="o">:</span>
<span class="p">...</span>  <span class="nx">def</span> <span class="nx">__html__</span><span class="p">(</span><span class="nx">self</span><span class="p">)</span><span class="o">:</span>
<span class="p">...</span>   <span class="k">return</span> <span class="s1">&#39;&lt;strong&gt;Nice&lt;/strong&gt;&#39;</span>
<span class="p">...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nx">escape</span><span class="p">(</span><span class="nx">Foo</span><span class="p">())</span>
<span class="nx">Markup</span><span class="p">(</span><span class="nx">u</span><span class="s1">&#39;&lt;strong&gt;Nice&lt;/strong&gt;&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nx">Markup</span><span class="p">(</span><span class="nx">Foo</span><span class="p">())</span>
<span class="nx">Markup</span><span class="p">(</span><span class="nx">u</span><span class="s1">&#39;&lt;strong&gt;Nice&lt;/strong&gt;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="silent-escapes">
<h2>Silent Escapes<a class="headerlink" href="#silent-escapes" title="Permalink to this headline">¶</a></h2>
<p>Since MarkupSafe 0.10 there is now also a separate escape function
called <cite>escape_silent</cite> that returns an empty string for <cite>None</cite> for
consistency with other systems that return empty strings for <cite>None</cite>
when escaping (for instance Pylons&#8217; webhelpers).</p>
<p>If you also want to use this for the escape method of the Markup
object, you can create your own subclass that does that:</p>
<div class="highlight-qml"><div class="highlight"><pre>from markupsafe import Markup, escape_silent as escape

class SilentMarkup(Markup):
    __slots__ = ()

    @classmethod
    def escape(cls, s):
        return cls(escape(s))
</pre></div>
</div>
</div>
<div class="section" id="new-style-string-formatting">
<h2>New-Style String Formatting<a class="headerlink" href="#new-style-string-formatting" title="Permalink to this headline">¶</a></h2>
<p>Starting with MarkupSafe 0.21 new style string formats from Python 2.6 and
3.x are now fully supported.  Previously the escape behavior of those
functions was spotty at best.  The new implementations operates under the
following algorithm:</p>
<ol class="arabic simple">
<li>if an object has an <code class="docutils literal"><span class="pre">__html_format__</span></code> method it is called as
replacement for <code class="docutils literal"><span class="pre">__format__</span></code> with the format specifier.  It either
has to return a string or markup object.</li>
<li>if an object has an <code class="docutils literal"><span class="pre">__html__</span></code> method it is called.</li>
<li>otherwise the default format system of Python kicks in and the result
is HTML escaped.</li>
</ol>
<p>Here is how you can implement your own formatting:</p>
<div class="highlight-qml"><div class="highlight"><pre><span class="kr">class</span> <span class="nx">User</span><span class="p">(</span><span class="nx">object</span><span class="p">)</span><span class="o">:</span>

    <span class="nx">def</span> <span class="nx">__init__</span><span class="p">(</span><span class="nx">self</span><span class="p">,</span> <span class="nx">id</span><span class="p">,</span> <span class="nx">username</span><span class="p">)</span><span class="o">:</span>
        <span class="nx">self</span><span class="p">.</span><span class="nx">id</span> <span class="o">=</span> <span class="nx">id</span>
        <span class="nx">self</span><span class="p">.</span><span class="nx">username</span> <span class="o">=</span> <span class="nx">username</span>

    <span class="nx">def</span> <span class="nx">__html_format__</span><span class="p">(</span><span class="nx">self</span><span class="p">,</span> <span class="nx">format_spec</span><span class="p">)</span><span class="o">:</span>
        <span class="k">if</span> <span class="nx">format_spec</span> <span class="o">==</span> <span class="s1">&#39;link&#39;</span><span class="o">:</span>
            <span class="k">return</span> <span class="nx">Markup</span><span class="p">(</span><span class="s1">&#39;&lt;a href=&quot;/user/{0}&quot;&gt;{1}&lt;/a&gt;&#39;</span><span class="p">).</span><span class="nx">format</span><span class="p">(</span>
                <span class="nx">self</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span>
                <span class="nx">self</span><span class="p">.</span><span class="nx">__html__</span><span class="p">(),</span>
            <span class="p">)</span>
        <span class="nx">elif</span> <span class="k">format_spec:</span>
            <span class="nx">raise</span> <span class="nx">ValueError</span><span class="p">(</span><span class="s1">&#39;Invalid format spec&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="nx">self</span><span class="p">.</span><span class="nx">__html__</span><span class="p">()</span>

    <span class="nx">def</span> <span class="nx">__html__</span><span class="p">(</span><span class="nx">self</span><span class="p">)</span><span class="o">:</span>
        <span class="k">return</span> <span class="nx">Markup</span><span class="p">(</span><span class="s1">&#39;&lt;span class=user&gt;{0}&lt;/span&gt;&#39;</span><span class="p">).</span><span class="nx">format</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">username</span><span class="p">)</span>
</pre></div>
</div>
<p>And to format that user:</p>
<div class="highlight-qml"><div class="highlight"><pre><span class="o">&gt;&gt;&gt;</span> <span class="nx">user</span> <span class="o">=</span> <span class="nx">User</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;foo&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nx">Markup</span><span class="p">(</span><span class="s1">&#39;&lt;p&gt;User: {0:link}&#39;</span><span class="p">).</span><span class="nx">format</span><span class="p">(</span><span class="nx">user</span><span class="p">)</span>
<span class="nx">Markup</span><span class="p">(</span><span class="nx">u</span><span class="s1">&#39;&lt;p&gt;User: &lt;a href=&quot;/user/1&quot;&gt;&lt;span class=user&gt;foo&lt;/span&gt;&lt;/a&gt;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>


    </div>
      
  </div>
</div>

<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2012-2014 Jürgen Bocklage-Ryannel and Johan Thelin. This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.<br/>
      Last updated on Jul 20, 2015.<br/>
    </p>
  </div>
</footer>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-46104829-1', 'auto');
  ga('send', 'pageview');

</script>

  </body>
</html>